<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>Tengwar en Catal√†</title>
  <style>
    @font-face {
      font-family: 'TengwarAnnatar';
      src: url('tngan.ttf') format('truetype');
    }

    body {
      font-family: "Segoe UI", sans-serif;
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      background-color: #fcfcfc;
      color: #333;
    }

    h1, h2 {
      color: #2c3e50;
    }

    .note {
      font-style: italic;
      color: #666;
    }

    .button {
      display: inline-block;
      padding: 10px 20px;
      background-color: #2ecc71;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
      transition: background-color 0.3s ease;
      margin-right: 10px;
      margin-top: 10px;
    }

    .button:hover {
      background-color: #27ae60;
    }

    textarea {
      width: 100%;
      font-size: 1.2em;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .tengwar {
      font-family: 'TengwarAnnatar', serif;
      font-size: 1.8em;
      line-height: 1.8;
      letter-spacing: 2px;
      white-space: pre-wrap;
      padding: 15px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 6px;
      margin-top: 10px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin: 15px 0;
      align-items: center;
    }

    select, input[type="range"] {
      padding: 6px;
      font-size: 1em;
    }
  </style>
</head>
<body>

<h1>Tengwar Mode Catal√†</h1>

<p>Aquesta p√†gina recull el treball de David Carrascal Rierola sobre com transcriure fon√®ticament el catal√† amb l'alfabet tengwar.</p>

<p class="note">S‚Äôha intentat que tots els dialectes de la llengua es trobin representats i puguin treballar amb el mode catal√† sense dificultats.</p>

<h2>Visualitza el document</h2>
<iframe src="catalan_tengwar.pdf" title="Mode Tengwar en catal√†"></iframe>

<br><br>
<a class="button" href="catalan_tengwar.pdf" download>‚¨á Descarrega el PDF</a>

<h2>Exemple escrit en Tengwar</h2>

<p class="tengwar">
zE51E 2(`V,O jL zHjL7( eJ5$(i1O 4(zTjyO jL zU`√ãj q7UwUzO7D `V5Utw7EwjLi iMe7Tt(R5, `√ãj, `√ãzUy(R, `B q7(iTqG1E t(^j1O, `C5%t(, `√ãieJ7iD4(i 2(7H`V, `√ã j#4(, `B `√ãji zUtw(71T`√ã `√ã5 qOi1U7( 4(ji v(^iM, `B t($f( 4( jL, yEi
</p>

<p class="note">
Canta, deesa, la c√≤lera funesta d'Aquil¬∑leu el Pelida, la qual provoc√† innombrables sofriments als aqueus i precipit√† moltes √†nimes esfor√ßades d'herois a l'Hades, i els convertia en pastura dels gossos i menja de les aus.
</p>

<h2>Transcriptor interactiu</h2>
<p>Escriu una frase en catal√† i la veur√†s transcrita autom√†ticament en Tengwar (amb portadors i tehta associades):</p>

<textarea id="inputText" rows="4">prova aquest transcriptor d'alfabet √®lfic per escriure en catal√†</textarea>

<div class="controls">
  <label for="fontSize">üìè Mida de lletra:</label>
  <input type="range" id="fontSize" min="1.0" max="3.5" step="0.1" value="1.8">

  <label for="fontStyle">üñã Estil:</label>
  <select id="fontStyle">
    <option value="normal">Normal</option>
    <option value="italic">Cursiva</option>
  </select>
</div>

<p class="note">Resultat aproximat en Tengwar:</p>
<div id="tengwarOutput" class="tengwar"></div>

<div class="button-row">
  <button class="button" onclick="copyToClipboard()">üìã Copia</button>
  <button class="button" onclick="exportAsImage()">üñº Exporta com a imatge</button>
</div>

<p><strong>Autor:</strong> David Carrascal Rierola ‚Äì <em>Herum√≠r√´</em></p>
<p><strong>Contacte:</strong> <a href="mailto:herumire@gmail.com">herumire@gmail.com</a></p>

<!-- html2canvas per exportar a imatge -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  const vocals = ['a', 'e', 'i', 'o', 'u'];

  const inputText = document.getElementById("inputText");
  const output = document.getElementById("tengwarOutput");
  const fontSizeInput = document.getElementById("fontSize");
  const fontStyleSelect = document.getElementById("fontStyle");

  function transcriu(text) {
    let result = [];
  
    let cleanText = text
      .toLowerCase()
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "") // Elimina accents
      .replace(/[^a-z√ß√±¬∑≈Ä ]/g, "");    // Mant√© la √ß perqu√® despr√©s la puguis substituir
  
    // Substitucions especials
    cleanText = cleanText
      .replace(/ll/g, 'ly')
      .replace(/ny/g, 'ny')
      .replace(/qu/g, 'k')
      .replace(/gu/g, 'g')
      .replace(/√ß/g, 's')  // ara s√≠, substitueix la √ß per s
      .replace(/√±/g, 'ny')
      .replace(/≈Ä/g, 'l');
  
    const vocals = ['a', 'e', 'i', 'o', 'u'];
    const paraules = cleanText.split(" ");
  
    for (let paraula of paraules) {
      let transcripcio = '';
      for (let i = 0; i < paraula.length; i++) {
        const l = paraula[i];
        const prev = paraula[i - 1];
  
        if (vocals.includes(l)) {
          if (i === 0 || (i > 0 && vocals.includes(prev))) {
            // Aqu√≠ pots posar un s√≠mbol visual que indiqui portador.
            // Per exemple, usa 'Àê' (U+02D0) que √©s un s√≠mbol de longitud, similar a dos punts per√≤ m√©s est√®tic.
            transcripcio += 'Àê' + l;
          } else {
            transcripcio += l;
          }
        } else {
          transcripcio += l;
        }
      }
      result.push(transcripcio);
    }

  return result.join(' ');
}


  function updateTranscription() {
    const text = inputText.value;
    const transcribed = transcriu(text);
    output.textContent = transcribed;
  }

  function copyToClipboard() {
    navigator.clipboard.writeText(output.textContent).then(() => {
      alert("Text copiat al porta-retalls!");
    }, () => {
      alert("No s'ha pogut copiar el text.");
    });
  }

  function exportAsImage() {
    html2canvas(output, { backgroundColor: null }).then(canvas => {
      const link = document.createElement('a');
      link.download = 'tengwar.png';
      link.href = canvas.toDataURL();
      link.click();
    });
  }

  inputText.addEventListener("input", updateTranscription);
  fontSizeInput.addEventListener("input", () => {
    output.style.fontSize = `${fontSizeInput.value}em`;
  });
  fontStyleSelect.addEventListener("change", () => {
    output.style.fontStyle = fontStyleSelect.value;
  });

  updateTranscription();
</script>

</body>
</html>
